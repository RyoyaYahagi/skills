---
name: autonomous-decision
description: "Load this skill BEFORE asking the user any question,
  requesting confirmation, seeking approval, asking what to do next,
  or stopping to wait for human input. Also load when you are unsure
  how to proceed, need to verify your work, or are about to present
  options to the user."
---

# Autonomous Decision — 自律判断スキル

**目的**: ユーザーに質問・確認を求めようとした瞬間に立ち止まり、「本当に人間に聞く必要があるか？」を自己判定する。自分で解決できることは自分でやり、人間の割り込みコストを最小化する。

## 発動タイミング

以下のいずれかを「しようとしている」と気づいた瞬間に、このスキルを適用する：

- ユーザーに質問しようとしている
- 確認・承認を求めようとしている
- 「次は何をすればいいですか？」と聞こうとしている
- 選択肢を提示して選んでもらおうとしている
- 作業を中断してユーザーの応答を待とうとしている
- 自分の判断に自信がなく、不安で聞きたくなっている

## 判断フローチャート

質問したくなったら、以下の順に自問する。**すべてNoの場合のみ**ユーザーに聞く。

```
1. 自分で検証できるか？
   → Yes: 検証手段マトリクス（後述）で自己解決
   → No: 次へ

2. 既存の情報源から答えが得られるか？
   → Obsidian ToDo / Daily Note / プロジェクトノート
   → ユーザーの過去の指示（会話履歴）
   → プロジェクトの rules.md / README
   → Yes: 参照して自己判断
   → No: 次へ

3. 判断を誤ってもリカバリー可能か？
   → git revert / undo で戻せる → 自分で判断して実行
   → 破壊的変更でない → 自分で判断して実行
   → リカバリー不可能 → ユーザーに聞く

4. 上記すべてNoかつリカバリー不可能
   → ユーザーにエスカレーション
```

## 検証手段マトリクス

「自分の作業結果を確認したい」場合は、以下のツールで**自己検証**する。人間に「合ってますか？」と聞かない。

| 確認したいこと                   | 検証手段                                       | 使うスキル/ツール                          |
| -------------------------------- | ---------------------------------------------- | ------------------------------------------ |
| テストが通るか                   | `npm test` / `swift test` / テストコマンド実行 | ターミナル直接実行                         |
| ビルドが成功するか               | `npm run build` / `xcodebuild` 実行            | ターミナル直接実行                         |
| UIが正しいか（Web）              | スクリーンショット撮影 + DOM検査               | `playwright-cli` / `web-devtools-debug`    |
| UIが正しいか（iOS）              | シミュレーター操作 + スクリーンショット        | `appium-simulator-test`                    |
| コンソールエラーがないか         | ブラウザコンソール確認                         | `web-devtools-debug` / chrome-devtools MCP |
| ネットワークリクエストが正しいか | DevToolsネットワークパネル確認                 | chrome-devtools MCP                        |
| リンター/型エラーがないか        | lint / type-check コマンド実行                 | ターミナル直接実行                         |
| git操作すべきか                  | `git status` + `git diff` で状態確認           | `git-ops` スキル                           |
| 次のタスクは何か                 | Obsidian ToDo + プロジェクトノート参照         | `obsidian-brain` / `project-hub`           |

### 検証手段がない場合

上記のいずれでも検証できないとき（例: 物理デバイスの動作確認、外部サービスの本番動作確認）は、**ユーザーに検証手段の提供を依頼する**。「合ってますか？」ではなく「〇〇を検証するために△△が必要です。用意できますか？」と聞く。

## よくあるシナリオ別の行動指針

### 「テストが通ったので push していいですか？」→ 聞かない

テストが全件パスし、lint/型チェックもクリアなら、`git-ops` スキルに従って自動コミット＆プッシュする。ユーザーの承認は不要。

### 「UIの見た目が正しいか確認してください」→ 自分で確認する

`playwright-cli screenshot` または chrome-devtools MCP の `take_screenshot` でスクリーンショットを撮り、期待するレイアウトと比較する。明らかな崩れがなければOKと判断して進む。

### 「次は何をすればいいですか？」→ 自分で判断する

1. ユーザーの直近の指示（会話履歴）を再確認
2. `obsidian-brain` で Daily Note / プロジェクトノートの ToDo を参照
3. `project-hub` で現在のプロジェクトの未完了タスクを確認
4. 現在の実装状態との差分から、次にやるべきことを特定
5. 特定できたら報告せずに着手する

### 「どちらの実装方法がいいですか？」→ 自分で決める

技術的な選択で、どちらを選んでも機能的に等価な場合は自分で選ぶ。判断基準：
- プロジェクトの既存パターンに合う方
- より一般的・標準的な方
- よりシンプルな方
- パフォーマンスが良い方（測定可能な場合）

### 「このエラーの原因がわかりません」→ 自分で調査する

1. エラーメッセージを読み、スタックトレースを追跡
2. 関連コードを読み、原因を特定
3. ログ出力を追加して再実行、追加情報を収集
4. Web関連なら `web-devtools-debug` でコンソール/ネットワーク確認
5. 3回リトライしても解決しなければユーザーにエスカレーション

### 「修正しましたが動作確認してもらえますか？」→ 自分で確認する

テスト実行 + UI確認（スクリーンショット or シミュレーター）で自己検証。検証結果を添えて完了報告する。

## エスカレーションが必要な場合（人間に聞くべきとき）

以下の場合は**必ず**ユーザーに聞く。自分で判断しない。

1. **ビジネス判断**: 機能の要件・仕様に関する曖昧さ（「この機能はAとBどちらの振る舞いが正しい？」）
2. **破壊的変更**: 本番データの削除、公開APIの破壊的変更、取り消し不可能な操作
3. **セキュリティ**: 認証・権限・秘密情報に関わる判断
4. **コスト**: 課金が発生する外部API呼び出し、大量リソースの消費
5. **検証手段なし**: 自分では確認できず、かつリカバリーも困難な状況
6. **明示的な指示**: ユーザーが「確認してから進めて」と明言している場合

## エスカレーション時のフォーマット

やむを得ずユーザーに聞く場合は、以下のフォーマットで**簡潔に**伝える：

```
🔍 **判断が必要です**

**状況**: [何をしていて、何に行き詰まったか — 1行で]
**試したこと**: [自分でどこまで調査/検証したか]
**選択肢**: [ある場合は推奨案をマークして提示]
```

「どうしましょう？」のような丸投げ質問は禁止。必ず自分の推奨案を含める。

## 関連スキル

- `git-ops` — テスト通過 + ビルド成功なら自動コミット＆プッシュ
- `obsidian-brain` — 次タスクの判断にToDo/Daily Noteを参照
- `project-hub` — プロジェクト進捗からタスク優先度を判断
- `playwright-cli` — Web UIのスクリーンショット検証
- `web-devtools-debug` — コンソールエラー/ネットワーク確認
- `appium-simulator-test` — iOS UIのシミュレーター検証
- `sandbox-escalation` — 権限不足時のみエスカレーション（本スキルの例外）
- `implementation-rules` — 実装フローの自動進行と連携
